
# ЁЯзСтАНЁЯФм Realtime Deepfake Face Swap (with InsightFace)

р╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣Мр╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╕Бр╕▓р╕гр╕кр╕ер╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╕Ър╕╕р╕Др╕Др╕ер╣Бр╕Ър╕Ър╣Ар╕гр╕╡р╕вр╕ер╣Др╕Чр╕бр╣Мр╕Ьр╣Ир╕▓р╕Щр╕Бр╕ер╣Йр╕нр╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕Др╕б р╣Вр╕Фр╕вр╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕ер╕Ир╕▓р╕Б InsightFace р╕Лр╕╢р╣Ир╕Зр╕бр╕╡р╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕Зр╣Бр╕ер╕░р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Фр╕╡р╣Ар╕вр╕╡р╣Ир╕вр╕б

## тЬЕ р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤

- р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Бр╕Ър╕Ър╣Ар╕гр╕╡р╕вр╕ер╣Др╕Чр╕бр╣Мр╕Фр╣Йр╕зр╕в `buffalo_l` face detection model
- р╕кр╕ер╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Ир╕▓р╕Бр╕ар╕▓р╕Юр╕Щр╕┤р╣Ир╕З р╣Др╕Ыр╕вр╕▒р╕Зр╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Гр╕Щр╕Бр╕ер╣Йр╕нр╕Зр╣Бр╕Ър╕Ъ live
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ CPU р╣Бр╕ер╕░ GPU (CUDA) р╕Фр╣Йр╕зр╕в ONNX Runtime
- р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Зр╣Ир╕▓р╕в р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Ар╕Вр╕╡р╕вр╕Щр╣Вр╕бр╣Ар╕Фр╕ер╣Ар╕нр╕З

## ЁЯУБ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М

```
.
тФЬтФАтФА main.py                  # р╣Вр╕Др╣Йр╕Фр╕лр╕ер╕▒р╕Б
тФЬтФАтФА models/
тФВ   тФФтФАтФА inswapper_128.onnx   # р╣Вр╕бр╣Ар╕Фр╕е face swapper (р╕Хр╣Йр╕нр╕Зр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕нр╕З)
тФЬтФАтФА images/
тФВ   тФЬтФАтФА prayut.jpg           # р╕ар╕▓р╕Юр╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╕Хр╣Йр╕Щр╕Чр╕▓р╕З
тФВ   тФФтФАтФА tono.jpg             # р╕ар╕▓р╕Юр╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕лр╕гр╕╖р╕нр╕ар╕▓р╕Юр╕нр╕╖р╣Ир╕Щр╣Ж
тФФтФАтФА README.md
```

## тЪЩя╕П р╕зр╕┤р╕Шр╕╡р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З

### 1. Clone р╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣М
```bash
git clone https://github.com/yourname/realtime-face-swap.git
cd realtime-face-swap
```

### 2. р╕кр╕гр╣Йр╕▓р╕З Virtual Environment (р╣Бр╕Щр╕░р╕Щр╕│)
```bash
python -m venv venv
source venv/bin/activate  # р╕кр╕│р╕лр╕гр╕▒р╕Ъ Linux/Mac
venv\Scripts\activate     # р╕кр╕│р╕лр╕гр╕▒р╕Ъ Windows
```

### 3. р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Dependency
```bash
pip install -r requirements.txt
```

р╕лр╕гр╕╖р╕н:

```bash
pip install insightface onnxruntime-gpu opencv-python numpy
```

### 4. р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Вр╕бр╣Ар╕Фр╕е `inswapper_128.onnx`
р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Ир╕▓р╕Б:
> https://github.com/deepinsight/insightface/tree/master/model_zoo

р╕Щр╕│р╣Др╕Яр╕ер╣М `.onnx` р╕бр╕▓р╣Гр╕кр╣Ир╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М `models/`

## ЁЯЪА р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

р╕гр╕▒р╕Щр╕Др╕│р╕кр╕▒р╣Ир╕З:

```bash
python main.py
```

р╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╣Ар╕Ыр╕┤р╕Фр╕Бр╕ер╣Йр╕нр╕З р╕Юр╕гр╣Йр╕нр╕бр╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Бр╕ер╕░р╕кр╕ер╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Гр╕Щр╣Ар╕зр╕ер╕▓р╕Ир╕гр╕┤р╕З

### р╕Бр╕▓р╕гр╕Бр╕Фр╕нр╕нр╕Б
р╕Бр╕Фр╕Ыр╕╕р╣Ир╕б **`q`** р╕Ър╕Щр╕Др╕╡р╕вр╣Мр╕Ър╕нр╕гр╣Мр╕Фр╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕нр╕Бр╕Ир╕▓р╕Бр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б

## ЁЯза р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Вр╕Др╣Йр╕Фр╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ

- `FaceAnalysis(name='buffalo_l')` р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╕Фр╣Йр╕зр╕вр╣Вр╕бр╣Ар╕Фр╕ер╕кр╕│р╣Ар╕гр╣Зр╕Ир╕гр╕╣р╕Ы
- `get_model('inswapper_128.onnx')` р╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕ер╕кр╕ер╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Бр╕Ър╕Ъ ONNX
- `face_app.get()` р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Гр╕Щр╕ар╕▓р╕Юр╕лр╕гр╕╖р╕нр╕зр╕┤р╕Фр╕╡р╣Вр╕н
- `swapper.get(...)` р╕Чр╕│р╕Бр╕▓р╕гр╕кр╕ер╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╕гр╕░р╕лр╕зр╣Ир╕▓р╕З source р╕Бр╕▒р╕Ъ target

## ЁЯУМ р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡ GPU р╣Гр╕лр╣Йр╣Гр╕Кр╣Й `providers = ['CPUExecutionProvider']`
- р╕Др╕зр╕▓р╕бр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕зр╕┤р╕Фр╕╡р╣Вр╕нр╕Цр╕╣р╕Бр╕Хр╕▒р╣Йр╕Зр╣Др╕зр╣Йр╕Чр╕╡р╣И 640x480 р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з
- р╣Вр╕бр╣Ар╕Фр╕ер╕Ир╕░р╕Цр╕╣р╕Бр╣Вр╕лр╕ер╕Фр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╣Вр╕Фр╕в InsightFace р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕Юр╕Ър╣Гр╕Щр╣Бр╕Др╕К р╕Ир╕░р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕нр╕З

## ЁЯУЬ License

MIT License
